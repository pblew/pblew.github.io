import{F as L,a as w,S as O,T as E,n as Q,s as R,U as Y,W as P,X as Z}from"./VTextField-fH_mrKsa.js";import{au as ee}from"./index-D-m9IlZp.js";function te(n){const m=new Float32Array(n*3),u=new Float32Array(n*3),f=new Float32Array(n*4),p=new Float32Array(n*2),i=new Float32Array(n*3),d=new Uint32Array(n);let l=0,v=0,y=0,g=0,r=0,A=0,h=0;function T(z,I,N,U,C){const[a,b,V]=z,[e,t,c]=I,{r:s,g:x,b:W,a:X}=N;if(m[l++]=a,m[l++]=b,m[l++]=V,u[v++]=e,u[v++]=t,u[v++]=c,f[y++]=s,f[y++]=x,f[y++]=W,f[y++]=X,U){const[q,G]=U;if(p[g++]=q,p[g++]=G,C){const[H,J,K]=C;i[r++]=H,i[r++]=J,i[r++]=K}}d[A++]=h++}function B(){d[A++]=h-1}return{vertexes:m,normals:u,colours:f,texcoords:p,tangents:i,indexes:d,emitVertex:T,emitDegenerateVertex:B}}function ne(n,m,u,f,p,i,d,l,v,y,g){return{buffer:n,ambient:m,diffuse:u,emissive:f,opacity:p,opticalDensity:i,shininess:d,specular:l,diffuseMap:v,normalMap:y,specularMap:g}}const _=w(),j=w(),F=E(),M=E();function k(n,m,u,f,p,i,d){L(_,u,m),L(j,f,m),O(F,i,p),O(M,d,p);const l=1/(F[0]*M[1]-M[0]*F[1]);return Number.isFinite(l)?(n[0]=l*(M[1]*_[0]-F[1]*j[0]),n[1]=l*(M[1]*_[1]-F[1]*j[1]),n[2]=l*(M[1]*_[2]-F[1]*j[2]),Q(n,n)):R(n,1,0,0),n}const $=w(),S=w(),D=E(),o=w();function oe(n){if(!n)return[];const{normals:m,texcoords:u,positions:f,parts:p}=n;return p.filter(i=>i.vertexCount>0).flatMap(i=>{const{vertexCount:d,materials:l,specularMap:v,normalMap:y,diffuseMap:g}=i,r=te(d);return l.map(A=>{const{ambient:h,diffuse:T,emissive:B,opacity:z,opticalDensity:I,shininess:N,specular:U,faces:C}=A,a=Y([...T,z]);return C.forEach(b=>{const V=b.length,e=b.map(s=>f[s[0]]),t=b.map(s=>{const x=u[s[1]];return ee(x[0],1-x[1])}),c=b.map(s=>m[s[2]]);switch(V){case 3:k(o,e[0],e[1],e[2],t[0],t[1],t[2]),r.emitVertex(e[0],c[0],a,t[0],o),r.emitVertex(e[1],c[1],a,t[1],o),r.emitVertex(e[2],c[2],a,t[2],o);break;case 4:k(o,e[0],e[1],e[2],t[0],t[1],t[2]),r.emitVertex(e[0],c[0],a,t[0],o),r.emitVertex(e[1],c[1],a,t[1],o),r.emitVertex(e[2],c[2],a,t[2],o),k(o,e[0],e[2],e[3],t[0],t[2],t[3]),r.emitVertex(e[0],c[0],a,t[0],o),r.emitVertex(e[2],c[2],a,t[2],o),r.emitVertex(e[3],c[3],a,t[3],o);break;default:P($,e,V),P(S,c,V),Z(D,t,V);for(let s=0;s<V;s++){const x=(s+1)%V;k(o,$,e[s],e[x],D,t[s],t[x]),r.emitVertex($,S,a,D,o),r.emitVertex(e[s],c[s],a,t[s],o),r.emitVertex(e[x],c[x],a,t[x],o)}}}),ne(r,h,T,B,z,I,N,U,g,y,v)})})}export{oe as f};
